<% if categories %>
  <ul>
    <% categories.each do |cat| %>
      <% unless cat.parent %>
        <li <%= class_if_current(:active, params, { :category => cat.url, :subcategory => nil }) %>>
          <%= link_to(cat.name, classifieds_url(:category => cat.url, :subcategory => nil)) %>
        </li>
      <% end %>
      <% counter = 0 %>
      <% if cat.children && cat.children.size > counter %>
        <ul>
          <% cat.children.each do |child_cat| %>
            <% if @ad %>
              <li <%= class_if_current(:active, { :category => child_cat.parent.url, :subcategory => child_cat.url }, { :category => @ad.category.parent.url, :subcategory => @ad.category.url }) %>>
            <% else %>
              <li <%= class_if_current(:active, params, { :category => child_cat.parent.url, :subcategory => child_cat.url }) %>>
            <% end %>
              <%= link_to(child_cat.name, classifieds_url(:category => child_cat.parent.url, :subcategory => child_cat.url)) %>
            </li>
            <% counter += 1 %>
          <% end %>
        </ul>
      <% end %>
    <% end %>
  </ul>
<% end %>